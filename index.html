<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pusat Game Bahasa Jepang</title>

    <!-- ========================= BAGIAN CSS ========================= -->
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --secondary-color: #db2777;
            --secondary-hover: #be185d;
            --correct-bg: #dcfce7;
            --correct-border: #22c55e;
            --correct-text: #166534;
            --incorrect-bg: #fee2e2;
            --incorrect-border: #ef4444;
            --incorrect-text: #991b1b;
            --neutral-bg: #f1f5f9;
            --text-dark: #1e293b;
            --text-light: #475569;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: var(--neutral-bg);
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            overflow: hidden; /* Mencegah scroll saat pop-up aktif */
        }
        .container {
            background-color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 700px;
            text-align: center;
        }
        h1, h2, h3 { color: var(--text-dark); }
        p { color: var(--text-light); }

        /* Tombol Umum */
        .btn {
            display: inline-block;
            padding: 12px 25px;
            margin: 5px;
            font-size: 1.1em;
            cursor: pointer;
            border-radius: 8px;
            border: none;
            background-color: var(--primary-color);
            color: white;
            transition: background-color 0.2s;
            font-weight: 500;
        }
        .btn:hover { background-color: var(--primary-hover); }
        .btn-secondary { background-color: #64748b; }
        .btn-secondary:hover { background-color: #475569; }
        .btn-kana { background-color: var(--secondary-color); }
        .btn-kana:hover { background-color: var(--secondary-hover); }

        /* Layar Awal & Pemilihan */
        .selection-group { margin: 20px 0; border-top: 1px solid #e2e8f0; padding-top: 20px; }

        /* Visibilitas Layar */
        .hidden { display: none; }

        /* Kontrol Musik */
        #music-control {
            position: fixed;
            bottom: 15px;
            right: 15px;
            width: 50px;
            height: 50px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        #music-control.visible {
            opacity: 1;
        }

        /* === [BARU] CSS UNTUK POP-UP ANIMASI === */
        #music-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            transition: background-color 0.3s;
        }
        #music-popup-box {
            background-color: white;
            padding: 30px 40px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 380px;
            /* Terapkan animasi muncul */
            animation: slideDown 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
        #music-popup-box.slide-up {
            /* Terapkan animasi hilang */
            animation: slideUp 0.5s cubic-bezier(0.55, 0.085, 0.68, 0.53) forwards;
        }
        #music-popup-box h3 {
            margin-top: 0;
            font-size: 1.5em;
            color: var(--text-dark);
        }
        #music-popup-box p {
            color: var(--text-light);
            margin-bottom: 25px;
            font-size: 1.05em;
        }
        #music-popup-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        /* Definisi Animasi Keyframes */
        @keyframes slideDown {
            from {
                transform: translateY(-150%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        @keyframes slideUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(-150%);
                opacity: 0;
            }
        }
    </style>
</head>
<body>

    <!-- ========================= BAGIAN HTML ========================= -->

    <!-- POP-UP UNTUK MUSIK -->
    <div id="music-popup-overlay">
        <div id="music-popup-box">
            <h3>Musik Latar</h3>
            <p>Apakah Anda ingin memutar musik selama bermain?</p>
            <div id="music-popup-buttons">
                <button id="play-music-btn" class="btn">Ya, Putar</button>
                <button id="no-music-btn" class="btn btn-secondary">Tidak</button>
            </div>
        </div>
    </div>

    <!-- ELEMEN AUDIO -->
    <audio id="background-music" src="sore1.mp3" loop></audio>

    <!-- TOMBOL KONTROL MUSIK (Awalnya disembunyikan) -->
    <button id="music-control" class="hidden">ðŸ”Š</button>

    <div class="container">
        <!-- Layar-layar game (tidak ada perubahan) -->
        <div id="category-screen">
            <h1>Pusat Game Bahasa Jepang</h1>
            <p>Pilih materi yang ingin kamu pelajari hari ini.</p>
            <div class="selection-group">
                <h3>Tes Kosakata</h3>
                <button class="btn" onclick="selectCategory('classroom')">Ungkapan di Kelas</button>
                <button class="btn" onclick="selectCategory('daily')">Salam Sehari-hari</button>
                <button class="btn" onclick="selectCategory('intro')">Perkenalan Diri</button>
            </div>
            <div class="selection-group">
                <h3>Tes Huruf Kana</h3>
                <button class="btn btn-kana" onclick="startGame('hiragana-test')">Tes Hiragana</button>
                <button class="btn btn-kana" onclick="startGame('katakana-test')">Tes Katakana</button>
            </div>
        </div>
        <!-- ... sisa layar game tidak diubah ... -->
    </div>

<!-- ========================= BAGIAN JAVASCRIPT (DENGAN LOGIKA ANIMASI) ========================= -->
<script>
    // --- KONTROL MUSIK DENGAN POP-UP ANIMASI ---
    const music = document.getElementById('background-music');
    const musicControlBtn = document.getElementById('music-control');
    const musicPopupOverlay = document.getElementById('music-popup-overlay');
    const musicPopupBox = document.getElementById('music-popup-box');
    const playMusicBtn = document.getElementById('play-music-btn');
    const noMusicBtn = document.getElementById('no-music-btn');
    let isMusicPlaying = false;
    music.volume = 0.3;

    // Fungsi untuk menyembunyikan pop-up dengan animasi
    function hidePopup() {
        // 1. Tambahkan kelas untuk memicu animasi 'slideUp'
        musicPopupBox.classList.add('slide-up');
        
        // 2. Setelah animasi selesai (500ms), sembunyikan elemen overlay
        setTimeout(() => {
            musicPopupOverlay.classList.add('hidden');
            musicControlBtn.classList.remove('hidden');
            musicControlBtn.classList.add('visible');
            document.body.style.overflow = 'auto'; // Kembalikan scroll
        }, 500);
    }

    // Fungsi untuk memulai musik
    function playMusic() {
        hidePopup(); // Sembunyikan pop-up dengan animasi
        music.play().then(() => {
            isMusicPlaying = true;
            musicControlBtn.textContent = 'ðŸ”Š';
        }).catch(error => {
            console.log("Autoplay gagal, perlu interaksi pengguna.", error);
            isMusicPlaying = false;
            musicControlBtn.textContent = 'ðŸ”‡';
        });
    }

    // Fungsi jika pengguna tidak ingin musik
    function declineMusic() {
        hidePopup(); // Sembunyikan pop-up dengan animasi
        isMusicPlaying = false;
        musicControlBtn.textContent = 'ðŸ”‡';
    }

    // Event listener untuk tombol di pop-up
    playMusicBtn.addEventListener('click', playMusic);
    noMusicBtn.addEventListener('click', declineMusic);

    // Event listener untuk tombol kontrol utama
    musicControlBtn.addEventListener('click', () => {
        if (isMusicPlaying) {
            music.pause();
            musicControlBtn.textContent = 'ðŸ”‡';
        } else {
            music.play();
            musicControlBtn.textContent = 'ðŸ”Š';
        }
        isMusicPlaying = !isMusicPlaying;
    });

    // --- SISA KODE GAME (TIDAK ADA PERUBAHAN) ---
    const vocabData = {
        classroom: [ { jp: "Hajimemashou", id: "Mari kita mulai" }, { jp: "Owarimashou", id: "Mari kita akhiri" }, { jp: "Yasumimashou", id: "Mari kita beristirahat" }, { jp: "Wakarimasuka", id: "Apakah anda mengerti?" }, { jp: "Hai, wakarimasu", id: "Ya, mengerti" }, { jp: "Iie, wakarimasen", id: "Tidak, tidak mengerti" }, { jp: "Itte kudasai", id: "Mohon dengarkan/ucapkan" }, { jp: "Mou ichido itte kudasai", id: "Ucapkan sekali lagi" }, { jp: "Yukkuri itte kudasai", id: "Ucapkan perlahan-lahan" }, { jp: "Isshoni douzo", id: "Mari bersama-sama" }, { jp: "Kaite kudasai", id: "Mohon di tulis/tulislah" }, { jp: "Yonde kudasai", id: "Mohon di baca/bacalah" }, { jp: "Hon o akete kudasai", id: "Bukalah buku" }, { jp: "Hon o tojite kudasai", id: "Tutuplah Buku" }, { jp: "Renshuu shite kudasai", id: "Berlatihlah" }, { jp: "Korede owarimasu", id: "Sampai di sini dulu" }, { jp: "Shitsumon ga arimasu ka", id: "Ada pertanyaan?" }, { jp: "Hai, arimasu", id: "Ya, ada" }, { jp: "Iie, arimasen", id: "Tidak, tidak ada" }, { jp: "Chotto matte kudasai", id: "Tunggu sebentar" }, { jp: "Kotaete kudasai", id: "Mohon dijawab/jawablah" }, { jp: "Ii desu", id: "Baik" }, { jp: "Chigaimasu", id: "Salah" }, { jp: "Okurete, sumimasen", id: "Maaf, (saya) terlambat datang" }, { jp: "Sumimasen, toire e itte mo ii desuka", id: "Maaf, bolehkah ke kamar kecil" } ],
        daily: [ { jp: "Ohayou gozaimasu", id: "Selamat pagi" }, { jp: "Konnichiwa", id: "Selamat siang" }, { jp: "Konbanwa", id: "Selamat malam" }, { jp: "Sayounara", id: "Selamat tinggal/selamat jalan" }, { jp: "Oyasuminasai", id: "Selamat tidur/selamat istirahat" }, { jp: "Omedetou gozaimasu", id: "Selamat" }, { jp: "Doumo arigatou gozaimasu", id: "Terima kasih" }, { jp: "Douitashimashite", id: "Terima kasih kembali" }, { jp: "Osakini shitsurei shimasu", id: "Saya permisi duluan" }, { jp: "Osakini Douzo", id: "Silahkan duluan" }, { jp: "Ki o tsukete kudasai", id: "Berhati-hatilah" }, { jp: "Dewa, mata (ja, mata)", id: "Sampai nanti" }, { jp: "Itadakimasu", id: "Terima kasih atas suguhan (sebelum makan)" }, { jp: "Gochisousama deshita", id: "Terima kasih atas hidangan (sesudah makan)" }, { jp: "Sumimasen", id: "Maaf/Permisi" }, { jp: "Gomen nasai", id: "Maaf" }, { jp: "Shitsurei shimasu", id: "Permisi" }, { jp: "Ogenki desuka", id: "Apa kabar?" }, { jp: "Hai, genki desu", id: "Baik/sehat-sehat saja" }, { jp: "Gomen kudasai", id: "Permisi (ucapan pada saat bertamu)" }, { jp: "Itte kimasu", id: "Saya pergi (dari rumah)" }, { jp: "Itte rasshai", id: "Selamat jalan" }, { jp: "Tadaima", id: "Saya kembali (pulang ke rumah)" }, { jp: "Okaeri nasai", id: "Selamat datang kembali" } ],
        intro: [ { jp: "Hajimemashite", id: "Perkenalkan" }, { jp: "Watashi wa [nama] to moushimasu", id: "Nama saya adalah [nama]" }, { jp: "Esu Kei Emu no gakusei desu", id: "Saya siswa dari LPK SKM" }, { jp: "[daerah asal] kara kimashita", id: "Saya datang dari [daerah asal]" }, { jp: "Douzo yoroshiku onegaishimasu", id: "Senang berkenalan dengan Anda" }, { jp: "Kochira koso, yoroshiku onegaishimasu", id: "Senang berkenalan dengan Anda juga" } ]
    };
    const kanaData = {
        hiragana: [ { kana: 'ã‚', romaji: 'a' }, { kana: 'ã„', romaji: 'i' }, { kana: 'ã†', romaji: 'u' }, { kana: 'ãˆ', romaji: 'e' }, { kana: 'ãŠ', romaji: 'o' }, { kana: 'ã‹', romaji: 'ka' }, { kana: 'ã', romaji: 'ki' }, { kana: 'ã', romaji: 'ku' }, { kana: 'ã‘', romaji: 'ke' }, { kana: 'ã“', romaji: 'ko' }, { kana: 'ã•', romaji: 'sa' }, { kana: 'ã—', romaji: 'shi' }, { kana: 'ã™', romaji: 'su' }, { kana: 'ã›', romaji: 'se' }, { kana: 'ã', romaji: 'so' }, { kana: 'ãŸ', romaji: 'ta' }, { kana: 'ã¡', romaji: 'chi' }, { kana: 'ã¤', romaji: 'tsu' }, { kana: 'ã¦', romaji: 'te' }, { kana: 'ã¨', romaji: 'to' }, { kana: 'ãª', romaji: 'na' }, { kana: 'ã«', romaji: 'ni' }, { kana: 'ã¬', romaji: 'nu' }, { kana: 'ã­', romaji: 'ne' }, { kana: 'ã®', romaji: 'no' }, { kana: 'ã¯', romaji: 'ha' }, { kana: 'ã²', romaji: 'hi' }, { kana: 'ãµ', romaji: 'fu' }, { kana: 'ã¸', romaji: 'he' }, { kana: 'ã»', romaji: 'ho' }, { kana: 'ã¾', romaji: 'ma' }, { kana: 'ã¿', romaji: 'mi' }, { kana: 'ã‚€', romaji: 'mu' }, { kana: 'ã‚', romaji: 'me' }, { kana: 'ã‚‚', romaji: 'mo' }, { kana: 'ã‚„', romaji: 'ya' }, { kana: 'ã‚†', romaji: 'yu' }, { kana: 'ã‚ˆ', romaji: 'yo' }, { kana: 'ã‚‰', romaji: 'ra' }, { kana: 'ã‚Š', romaji: 'ri' }, { kana: 'ã‚‹', romaji: 'ru' }, { kana: 'ã‚Œ', romaji: 're' }, { kana: 'ã‚', romaji: 'ro' }, { kana: 'ã‚', romaji: 'wa' }, { kana: 'ã‚’', romaji: 'wo' }, { kana: 'ã‚“', romaji: 'n' } ],
        katakana: [ { kana: 'ã‚¢', romaji: 'a' }, { kana: 'ã‚¤', romaji: 'i' }, { kana: 'ã‚¦', romaji: 'u' }, { kana: 'ã‚¨', romaji: 'e' }, { kana: 'ã‚ª', romaji: 'o' }, { kana: 'ã‚«', romaji: 'ka' }, { kana: 'ã‚­', romaji: 'ki' }, { kana: 'ã‚¯', romaji: 'ku' }, { kana: 'ã‚±', romaji: 'ke' }, { kana: 'ã‚³', romaji: 'ko' }, { kana: 'ã‚µ', romaji: 'sa' }, { kana: 'ã‚·', romaji: 'shi' }, { kana: 'ã‚¹', romaji: 'su' }, { kana: 'ã‚»', romaji: 'se' }, { kana: 'ã‚½', romaji: 'so' }, { kana: 'ã‚¿', romaji: 'ta' }, { kana: 'ãƒ', romaji: 'chi' }, { kana: 'ãƒ„', romaji: 'tsu' }, { kana: 'ãƒ†', romaji: 'te' }, { kana: 'ãƒˆ', romaji: 'to' }, { kana: 'ãƒŠ', romaji: 'na' }, { kana: 'ãƒ‹', romaji: 'ni' }, { kana: 'ãƒŒ', romaji: 'nu' }, { kana: 'ãƒ', romaji: 'ne' }, { kana: 'ãƒŽ', romaji: 'no' }, { kana: 'ãƒ', romaji: 'ha' }, { kana: 'ãƒ’', romaji: 'hi' }, { kana: 'ãƒ•', romaji: 'fu' }, { kana: 'ãƒ˜', romaji: 'he' }, { kana: 'ãƒ›', romaji: 'ho' }, { kana: 'ãƒž', romaji: 'ma' }, { kana: 'ãƒŸ', romaji: 'mi' }, { kana: 'ãƒ ', romaji: 'mu' }, { kana: 'ãƒ¡', romaji: 'me' }, { kana: 'ãƒ¢', romaji: 'mo' }, { kana: 'ãƒ¤', romaji: 'ya' }, { kana: 'ãƒ¦', romaji: 'yu' }, { kana: 'ãƒ¨', romaji: 'yo' }, { kana: 'ãƒ©', romaji: 'ra' }, { kana: 'ãƒª', romaji: 'ri' }, { kana: 'ãƒ«', romaji: 'ru' }, { kana: 'ãƒ¬', romaji: 're' }, { kana: 'ãƒ­', romaji: 'ro' }, { kana: 'ãƒ¯', romaji: 'wa' }, { kana: 'ãƒ²', romaji: 'wo' }, { kana: 'ãƒ³', romaji: 'n' } ]
    };
    let currentCategory, currentGameType, currentDataSet, score;
    const screens = document.querySelectorAll('.container > div');
    function showScreen(screenId) { screens.forEach(s => s.classList.add('hidden')); document.getElementById(screenId).classList.remove('hidden'); }
    function selectCategory(category) { currentCategory = category; const titles = { classroom: 'Ungkapan di Kelas', daily: 'Salam Sehari-hari', intro: 'Perkenalan Diri' }; document.getElementById('game-selection-title').textContent = titles[category]; showScreen('game-selection-screen'); }
    function startGame(type) { if (type.includes('-test')) { currentGameType = type; currentCategory = null; startMultipleChoice(); } else { currentGameType = type; currentDataSet = [...vocabData[currentCategory]]; if (type === 'multiple-choice') startMultipleChoice(); else if (type === 'drag-drop') startDragDrop(); } }
    function restartGame() { startGame(currentGameType); }
    let mcQuestionIndex, mcShuffledQuestions, mcCorrectCount, mcIncorrectCount;
    function startMultipleChoice() { /* ... kode game tidak berubah ... */ }
    function updateMcStats() { /* ... kode game tidak berubah ... */ }
    function showMcQuestion() { /* ... kode game tidak berubah ... */ }
    function checkMcAnswer(selectedButton, selectedOption, correctAnswer) { /* ... kode game tidak berubah ... */ }
    document.getElementById('mc-next-btn').addEventListener('click', () => { /* ... kode game tidak berubah ... */ });
    function startDragDrop() { /* ... kode game tidak berubah ... */ }
    function addDragDropListeners() { /* ... kode game tidak berubah ... */ }
    document.getElementById('dd-check-btn').addEventListener('click', () => { /* ... kode game tidak berubah ... */ });
    function showEndScreen(finalScore, maxScore) { /* ... kode game tidak berubah ... */ }
    
    // Inisialisasi: Tampilkan layar kategori utama (pop-up akan muncul di atasnya)
    showScreen('category-screen');

    // (Saya sengaja meringkas fungsi-fungsi game yang tidak berubah agar lebih ringkas,
    // tapi di kode Anda, biarkan saja seperti apa adanya)
</script>

</body>
</html>
